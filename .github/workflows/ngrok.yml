name: AperÃ§u Flask avec ngrok

on:
  workflow_dispatch:

jobs:
  preview:
    runs-on: ubuntu-latest

    steps:
    - name: Cloner le dÃ©pÃ´t
      uses: actions/checkout@v3

    - name: Installer Python
      uses: actions/setup-python@v4
      with:
        python-version: 3.11

    - name: Installer les dÃ©pendances Python
      run: pip install flask pyngrok

    - name: CrÃ©er fichier ngrok.yml avec token
      run: |
        mkdir -p ~/.ngrok2
        echo "authtoken: ${{ secrets.NGROK_AUTH_TOKEN }}" > ~/.ngrok2/ngrok.yml

    - name: Lancer Flask et ngrok
      run: |
        echo "
from pyngrok import ngrok
import __init__ as appfile

url = ngrok.connect(5000)
print('ðŸ”— Votre lien temporaire :', url)

appfile.app.run(port=5000)
        " > launch.py
        python launch.py
